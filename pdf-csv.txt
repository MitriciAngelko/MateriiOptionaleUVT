In /admin-materii a very important feature is needed. It should be a section that automatically adds in bulk all the courses and courses data. Before starting let me explain the flow:

The admin will have in that page an additional form with the already existing Facultate and Specializare fields that are existant in the manual process of adding the courses.

In addition will be able to upload a pdf file.

Once the bulk add courses button is pressed it will trigger an function handle to send the form to an open ai assistent (will provide the code bellow for the assistent) using responses API.

A interactive loading spinner with some funny messages about loading (in romanian) will apear until you get a response from the api endpoint.

The response will consist of a CSV with Course name, Status (Mandatory or Optional), Semester, Year, Credits.

A mapping will be needed for Status, specifically the values Facultative and Optional. Those should be processed as Optional.

The most crucial part is to see how materii documents have the fields and then map each value to the coresponding field (example Optional is the Obligatorie: false field and value).

Then all those courses need to be bulk uploaded in Firebase, materii.

Be really careful with each step and complement if something was omitted. Think on each step and analyse the code.

Here is also the response API assistant for the pdf to csv:

import OpenAI from "openai";

const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY,
});

const response = await openai.responses.create({
  model: "gpt-4.1",
  input: [
    {
      "role": "system",
      "content": [
        {
          "type": "input_text",
          "text": "You are an expert in content extraction from pdf's poorly made. You extract in the most accurate way all the necessary data even when there are mismatches in rows (multiple values in one row should be accounted  and counted as separate values).\n\nExtract a complete list of all courses (mandatory and optional, also facultative) from this academic curriculum document. For each course, extract and present the following information in a structured CSV: Course name, Status (Mandatory or Optional), Semester, Year, Total credits Additionally: Treat every optional course in grouped packages as an individual course (i.e. count all options separately even if only one is chosen).  EXTRACT ONLY IN  CSV Year 1 Semester 1 and Semester 2, Year 2 Semester 1 and Semester 2, Year 3 Semester 1 and Semester 2. \nEveryone is counting on you.\n\nRULES\n- EXTRACT ONLY IN  CSV FORMAT!\n- DON'T FORGET TO DO IT FOR ALL SEMESTERS AND YEARS!\n- RETURN ONLY THE CSV AS RESPONSE AND NOTHING MORE!\n- BE CAREFUL TO EXCTACT THE CORRECT DATA IN THE CORRECT COLUMN!\n- IF THE TITLE HAS COMMA (,) THEN REPLACE IT WITH DASH (-)!\n- Structured CSV: Course name, Status (Mandatory or Optional), Semester, Year, Credits"
        }
      ]
    }
  ],
  text: {
    "format": {
      "type": "text"
    }
  },
  reasoning: {},
  tools: [],
  temperature: 1,
  max_output_tokens: 32768,
  top_p: 1,
  store: true
});